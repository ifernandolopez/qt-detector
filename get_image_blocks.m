function M = get_image_blocks(input_file)% Return a bidimensional array of blocksN = 8; % 8x8 blocksI = imread(input_file); % If RGB, extract the Y channelif (ndims(I)==3)  I = rgb2gray(I);end[rows, cols] = size(I);rows = floor(rows/N);cols = floor(cols/N);M = cell(rows,cols);% Iterate blocksfor i=1:rows  for j=1:cols    M{i,j} = I((i-1)*N+1:i*N,(j-1)*N+1:j*N);  endend